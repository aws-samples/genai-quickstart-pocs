"use strict";
/**
 * Standalone Integration Test
 * Independent test that doesn't rely on existing codebase
 */
describe('Standalone Integration Test', () => {
    describe('Test Framework Validation', () => {
        it('should run basic Jest assertions', () => {
            expect(1 + 1).toBe(2);
            expect('hello').toBe('hello');
            expect([1, 2, 3]).toHaveLength(3);
            expect({ name: 'test' }).toHaveProperty('name', 'test');
        });
        it('should handle async operations', async () => {
            const asyncOperation = () => new Promise(resolve => setTimeout(() => resolve('completed'), 10));
            const result = await asyncOperation();
            expect(result).toBe('completed');
        });
        it('should validate test environment variables', () => {
            expect(process.env.NODE_ENV).toBe('test'); // Jest sets this to 'test' by default
            expect(process.env.AWS_REGION).toBe('us-east-1');
            expect(process.env.JWT_SECRET).toBe('test-jwt-secret'); // Set by main setup.ts
        });
        it('should have Jest globals available', () => {
            expect(jest).toBeDefined();
            expect(expect).toBeDefined();
            expect(describe).toBeDefined();
            expect(it).toBeDefined();
            expect(beforeAll).toBeDefined();
            expect(afterAll).toBeDefined();
            expect(beforeEach).toBeDefined();
            expect(afterEach).toBeDefined();
        });
    });
    describe('Integration Test Capabilities', () => {
        it('should handle concurrent async operations', async () => {
            const operations = Array(5).fill(null).map(async (_, index) => {
                // Simulate async work
                await new Promise(resolve => setTimeout(resolve, Math.random() * 10));
                return `result-${index}`;
            });
            const results = await Promise.all(operations);
            expect(results).toHaveLength(5);
            results.forEach((result, index) => {
                expect(result).toBe(`result-${index}`);
            });
        });
        it('should support error handling in async operations', async () => {
            const failingOperation = async () => {
                throw new Error('Test error');
            };
            await expect(failingOperation()).rejects.toThrow('Test error');
        });
        it('should handle timeouts appropriately', async () => {
            const slowOperation = () => new Promise(resolve => setTimeout(() => resolve('slow result'), 100));
            const startTime = Date.now();
            const result = await slowOperation();
            const endTime = Date.now();
            expect(result).toBe('slow result');
            expect(endTime - startTime).toBeGreaterThanOrEqual(90);
            expect(endTime - startTime).toBeLessThan(200);
        });
    });
    describe('Mock and Spy Functionality', () => {
        it('should support Jest mocks', () => {
            const mockFunction = jest.fn();
            mockFunction('test-arg');
            expect(mockFunction).toHaveBeenCalledWith('test-arg');
            expect(mockFunction).toHaveBeenCalledTimes(1);
        });
        it('should support Jest spies', () => {
            const testObject = {
                method: (arg) => `processed-${arg}`
            };
            const spy = jest.spyOn(testObject, 'method');
            const result = testObject.method('input');
            expect(spy).toHaveBeenCalledWith('input');
            expect(result).toBe('processed-input');
            spy.mockRestore();
        });
        it('should support mock implementations', () => {
            const mockFunction = jest.fn().mockImplementation((x) => x * 2);
            expect(mockFunction(5)).toBe(10);
            expect(mockFunction(3)).toBe(6);
            expect(mockFunction).toHaveBeenCalledTimes(2);
        });
    });
    describe('Data Validation and Processing', () => {
        it('should validate JSON data structures', () => {
            const testData = {
                id: 'test-123',
                name: 'Test Item',
                metadata: {
                    created: new Date().toISOString(),
                    tags: ['test', 'integration']
                }
            };
            expect(testData).toHaveProperty('id');
            expect(testData).toHaveProperty('name');
            expect(testData).toHaveProperty('metadata');
            expect(testData.metadata).toHaveProperty('created');
            expect(testData.metadata).toHaveProperty('tags');
            expect(Array.isArray(testData.metadata.tags)).toBe(true);
            expect(testData.metadata.tags).toContain('test');
        });
        it('should handle array operations', () => {
            const numbers = [1, 2, 3, 4, 5];
            const doubled = numbers.map(n => n * 2);
            const filtered = numbers.filter(n => n > 3);
            const sum = numbers.reduce((acc, n) => acc + n, 0);
            expect(doubled).toEqual([2, 4, 6, 8, 10]);
            expect(filtered).toEqual([4, 5]);
            expect(sum).toBe(15);
        });
        it('should validate string operations', () => {
            const testString = 'Integration Test Framework';
            expect(testString).toMatch(/Integration/);
            expect(testString.toLowerCase()).toBe('integration test framework');
            expect(testString.split(' ')).toHaveLength(3);
            expect(testString.includes('Test')).toBe(true);
        });
    });
    describe('Performance and Timing', () => {
        it('should complete operations within reasonable time', async () => {
            const startTime = Date.now();
            // Simulate some computational work
            let result = 0;
            for (let i = 0; i < 1000; i++) {
                result += Math.random();
            }
            const endTime = Date.now();
            const duration = endTime - startTime;
            expect(result).toBeGreaterThan(0);
            expect(duration).toBeLessThan(100); // Should complete quickly
        });
        it('should handle parallel operations efficiently', async () => {
            const startTime = Date.now();
            const parallelOperations = Array(10).fill(null).map(async (_, index) => {
                await new Promise(resolve => setTimeout(resolve, 5));
                return index * 2;
            });
            const results = await Promise.all(parallelOperations);
            const endTime = Date.now();
            const duration = endTime - startTime;
            expect(results).toHaveLength(10);
            expect(results[5]).toBe(10); // 5 * 2
            expect(duration).toBeLessThan(50); // Parallel execution should be fast
        });
    });
    describe('Error Scenarios and Edge Cases', () => {
        it('should handle null and undefined values', () => {
            const nullValue = null;
            const undefinedValue = undefined;
            const emptyString = '';
            const emptyArray = [];
            const emptyObject = {};
            expect(nullValue).toBeNull();
            expect(undefinedValue).toBeUndefined();
            expect(emptyString).toBe('');
            expect(emptyString).toHaveLength(0);
            expect(emptyArray).toHaveLength(0);
            expect(Object.keys(emptyObject)).toHaveLength(0);
        });
        it('should handle type checking', () => {
            const stringValue = 'test';
            const numberValue = 42;
            const booleanValue = true;
            const arrayValue = [1, 2, 3];
            const objectValue = { key: 'value' };
            expect(typeof stringValue).toBe('string');
            expect(typeof numberValue).toBe('number');
            expect(typeof booleanValue).toBe('boolean');
            expect(Array.isArray(arrayValue)).toBe(true);
            expect(typeof objectValue).toBe('object');
            expect(objectValue).not.toBeNull();
        });
        it('should handle boundary conditions', () => {
            const maxSafeInteger = Number.MAX_SAFE_INTEGER;
            const minSafeInteger = Number.MIN_SAFE_INTEGER;
            const positiveInfinity = Number.POSITIVE_INFINITY;
            const negativeInfinity = Number.NEGATIVE_INFINITY;
            expect(Number.isSafeInteger(maxSafeInteger)).toBe(true);
            expect(Number.isSafeInteger(minSafeInteger)).toBe(true);
            expect(Number.isFinite(positiveInfinity)).toBe(false);
            expect(Number.isFinite(negativeInfinity)).toBe(false);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhbmRhbG9uZS1pbnRlZ3JhdGlvbi50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL19fdGVzdHNfXy9pbnRlZ3JhdGlvbi9zdGFuZGFsb25lLWludGVncmF0aW9uLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRztBQUVILFFBQVEsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7SUFDM0MsUUFBUSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtRQUN6QyxFQUFFLENBQUMsa0NBQWtDLEVBQUUsR0FBRyxFQUFFO1lBQzFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3RCLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDOUIsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNsQyxNQUFNLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQzFELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdDQUFnQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzlDLE1BQU0sY0FBYyxHQUFHLEdBQUcsRUFBRSxDQUFDLElBQUksT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQ2pELFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQzNDLENBQUM7WUFFRixNQUFNLE1BQU0sR0FBRyxNQUFNLGNBQWMsRUFBRSxDQUFDO1lBQ3RDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDbkMs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LFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3hELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU3RhbmRhbG9uZSBJbnRlZ3JhdGlvbiBUZXN0XG4gKiBJbmRlcGVuZGVudCB0ZXN0IHRoYXQgZG9lc24ndCByZWx5IG9uIGV4aXN0aW5nIGNvZGViYXNlXG4gKi9cblxuZGVzY3JpYmUoJ1N0YW5kYWxvbmUgSW50ZWdyYXRpb24gVGVzdCcsICgpID0+IHtcbiAgZGVzY3JpYmUoJ1Rlc3QgRnJhbWV3b3JrIFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBydW4gYmFzaWMgSmVzdCBhc3NlcnRpb25zJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KDEgKyAxKS50b0JlKDIpO1xuICAgICAgZXhwZWN0KCdoZWxsbycpLnRvQmUoJ2hlbGxvJyk7XG4gICAgICBleHBlY3QoWzEsIDIsIDNdKS50b0hhdmVMZW5ndGgoMyk7XG4gICAgICBleHBlY3QoeyBuYW1lOiAndGVzdCcgfSkudG9IYXZlUHJvcGVydHkoJ25hbWUnLCAndGVzdCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXN5bmMgb3BlcmF0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGFzeW5jT3BlcmF0aW9uID0gKCkgPT4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZXNvbHZlKCdjb21wbGV0ZWQnKSwgMTApXG4gICAgICApO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhc3luY09wZXJhdGlvbigpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnY29tcGxldGVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHRlc3QgZW52aXJvbm1lbnQgdmFyaWFibGVzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KHByb2Nlc3MuZW52Lk5PREVfRU5WKS50b0JlKCd0ZXN0Jyk7IC8vIEplc3Qgc2V0cyB0aGlzIHRvICd0ZXN0JyBieSBkZWZhdWx0XG4gICAgICBleHBlY3QocHJvY2Vzcy5lbnYuQVdTX1JFR0lPTikudG9CZSgndXMtZWFzdC0xJyk7XG4gICAgICBleHBlY3QocHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCkudG9CZSgndGVzdC1qd3Qtc2VjcmV0Jyk7IC8vIFNldCBieSBtYWluIHNldHVwLnRzXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgSmVzdCBnbG9iYWxzIGF2YWlsYWJsZScsICgpID0+IHtcbiAgICAgIGV4cGVjdChqZXN0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGV4cGVjdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChkZXNjcmliZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChpdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChiZWZvcmVBbGwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoYWZ0ZXJBbGwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoYmVmb3JlRWFjaCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChhZnRlckVhY2gpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnRlZ3JhdGlvbiBUZXN0IENhcGFiaWxpdGllcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb25jdXJyZW50IGFzeW5jIG9wZXJhdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBvcGVyYXRpb25zID0gQXJyYXkoNSkuZmlsbChudWxsKS5tYXAoYXN5bmMgKF8sIGluZGV4KSA9PiB7XG4gICAgICAgIC8vIFNpbXVsYXRlIGFzeW5jIHdvcmtcbiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIE1hdGgucmFuZG9tKCkgKiAxMCkpO1xuICAgICAgICByZXR1cm4gYHJlc3VsdC0ke2luZGV4fWA7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKG9wZXJhdGlvbnMpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0cykudG9IYXZlTGVuZ3RoKDUpO1xuICAgICAgcmVzdWx0cy5mb3JFYWNoKChyZXN1bHQsIGluZGV4KSA9PiB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoYHJlc3VsdC0ke2luZGV4fWApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN1cHBvcnQgZXJyb3IgaGFuZGxpbmcgaW4gYXN5bmMgb3BlcmF0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZhaWxpbmdPcGVyYXRpb24gPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGVzdCBlcnJvcicpO1xuICAgICAgfTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGZhaWxpbmdPcGVyYXRpb24oKSkucmVqZWN0cy50b1Rocm93KCdUZXN0IGVycm9yJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB0aW1lb3V0cyBhcHByb3ByaWF0ZWx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc2xvd09wZXJhdGlvbiA9ICgpID0+IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVzb2x2ZSgnc2xvdyByZXN1bHQnKSwgMTAwKVxuICAgICAgKTtcblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNsb3dPcGVyYXRpb24oKTtcbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdzbG93IHJlc3VsdCcpO1xuICAgICAgZXhwZWN0KGVuZFRpbWUgLSBzdGFydFRpbWUpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoOTApO1xuICAgICAgZXhwZWN0KGVuZFRpbWUgLSBzdGFydFRpbWUpLnRvQmVMZXNzVGhhbigyMDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTW9jayBhbmQgU3B5IEZ1bmN0aW9uYWxpdHknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzdXBwb3J0IEplc3QgbW9ja3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRnVuY3Rpb24gPSBqZXN0LmZuKCk7XG4gICAgICBtb2NrRnVuY3Rpb24oJ3Rlc3QtYXJnJyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtb2NrRnVuY3Rpb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCd0ZXN0LWFyZycpO1xuICAgICAgZXhwZWN0KG1vY2tGdW5jdGlvbikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzdXBwb3J0IEplc3Qgc3BpZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0ZXN0T2JqZWN0ID0ge1xuICAgICAgICBtZXRob2Q6IChhcmc6IHN0cmluZykgPT4gYHByb2Nlc3NlZC0ke2FyZ31gXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBzcHkgPSBqZXN0LnNweU9uKHRlc3RPYmplY3QsICdtZXRob2QnKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHRlc3RPYmplY3QubWV0aG9kKCdpbnB1dCcpO1xuICAgICAgXG4gICAgICBleHBlY3Qoc3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnaW5wdXQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ3Byb2Nlc3NlZC1pbnB1dCcpO1xuICAgICAgXG4gICAgICBzcHkubW9ja1Jlc3RvcmUoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3VwcG9ydCBtb2NrIGltcGxlbWVudGF0aW9ucycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tGdW5jdGlvbiA9IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKHg6IG51bWJlcikgPT4geCAqIDIpO1xuICAgICAgXG4gICAgICBleHBlY3QobW9ja0Z1bmN0aW9uKDUpKS50b0JlKDEwKTtcbiAgICAgIGV4cGVjdChtb2NrRnVuY3Rpb24oMykpLnRvQmUoNik7XG4gICAgICBleHBlY3QobW9ja0Z1bmN0aW9uKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdEYXRhIFZhbGlkYXRpb24gYW5kIFByb2Nlc3NpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBKU09OIGRhdGEgc3RydWN0dXJlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3REYXRhID0ge1xuICAgICAgICBpZDogJ3Rlc3QtMTIzJyxcbiAgICAgICAgbmFtZTogJ1Rlc3QgSXRlbScsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgY3JlYXRlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHRhZ3M6IFsndGVzdCcsICdpbnRlZ3JhdGlvbiddXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdCh0ZXN0RGF0YSkudG9IYXZlUHJvcGVydHkoJ2lkJyk7XG4gICAgICBleHBlY3QodGVzdERhdGEpLnRvSGF2ZVByb3BlcnR5KCduYW1lJyk7XG4gICAgICBleHBlY3QodGVzdERhdGEpLnRvSGF2ZVByb3BlcnR5KCdtZXRhZGF0YScpO1xuICAgICAgZXhwZWN0KHRlc3REYXRhLm1ldGFkYXRhKS50b0hhdmVQcm9wZXJ0eSgnY3JlYXRlZCcpO1xuICAgICAgZXhwZWN0KHRlc3REYXRhLm1ldGFkYXRhKS50b0hhdmVQcm9wZXJ0eSgndGFncycpO1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkodGVzdERhdGEubWV0YWRhdGEudGFncykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QodGVzdERhdGEubWV0YWRhdGEudGFncykudG9Db250YWluKCd0ZXN0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhcnJheSBvcGVyYXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgbnVtYmVycyA9IFsxLCAyLCAzLCA0LCA1XTtcbiAgICAgIGNvbnN0IGRvdWJsZWQgPSBudW1iZXJzLm1hcChuID0+IG4gKiAyKTtcbiAgICAgIGNvbnN0IGZpbHRlcmVkID0gbnVtYmVycy5maWx0ZXIobiA9PiBuID4gMyk7XG4gICAgICBjb25zdCBzdW0gPSBudW1iZXJzLnJlZHVjZSgoYWNjLCBuKSA9PiBhY2MgKyBuLCAwKTtcblxuICAgICAgZXhwZWN0KGRvdWJsZWQpLnRvRXF1YWwoWzIsIDQsIDYsIDgsIDEwXSk7XG4gICAgICBleHBlY3QoZmlsdGVyZWQpLnRvRXF1YWwoWzQsIDVdKTtcbiAgICAgIGV4cGVjdChzdW0pLnRvQmUoMTUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBzdHJpbmcgb3BlcmF0aW9ucycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3RTdHJpbmcgPSAnSW50ZWdyYXRpb24gVGVzdCBGcmFtZXdvcmsnO1xuICAgICAgXG4gICAgICBleHBlY3QodGVzdFN0cmluZykudG9NYXRjaCgvSW50ZWdyYXRpb24vKTtcbiAgICAgIGV4cGVjdCh0ZXN0U3RyaW5nLnRvTG93ZXJDYXNlKCkpLnRvQmUoJ2ludGVncmF0aW9uIHRlc3QgZnJhbWV3b3JrJyk7XG4gICAgICBleHBlY3QodGVzdFN0cmluZy5zcGxpdCgnICcpKS50b0hhdmVMZW5ndGgoMyk7XG4gICAgICBleHBlY3QodGVzdFN0cmluZy5pbmNsdWRlcygnVGVzdCcpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGVyZm9ybWFuY2UgYW5kIFRpbWluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNvbXBsZXRlIG9wZXJhdGlvbnMgd2l0aGluIHJlYXNvbmFibGUgdGltZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICBcbiAgICAgIC8vIFNpbXVsYXRlIHNvbWUgY29tcHV0YXRpb25hbCB3b3JrXG4gICAgICBsZXQgcmVzdWx0ID0gMDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTAwMDsgaSsrKSB7XG4gICAgICAgIHJlc3VsdCArPSBNYXRoLnJhbmRvbSgpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBlbmRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gZW5kVGltZSAtIHN0YXJ0VGltZTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KGR1cmF0aW9uKS50b0JlTGVzc1RoYW4oMTAwKTsgLy8gU2hvdWxkIGNvbXBsZXRlIHF1aWNrbHlcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHBhcmFsbGVsIG9wZXJhdGlvbnMgZWZmaWNpZW50bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgXG4gICAgICBjb25zdCBwYXJhbGxlbE9wZXJhdGlvbnMgPSBBcnJheSgxMCkuZmlsbChudWxsKS5tYXAoYXN5bmMgKF8sIGluZGV4KSA9PiB7XG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1KSk7XG4gICAgICAgIHJldHVybiBpbmRleCAqIDI7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKHBhcmFsbGVsT3BlcmF0aW9ucyk7XG4gICAgICBcbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0cykudG9IYXZlTGVuZ3RoKDEwKTtcbiAgICAgIGV4cGVjdChyZXN1bHRzWzVdKS50b0JlKDEwKTsgLy8gNSAqIDJcbiAgICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDUwKTsgLy8gUGFyYWxsZWwgZXhlY3V0aW9uIHNob3VsZCBiZSBmYXN0XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFcnJvciBTY2VuYXJpb3MgYW5kIEVkZ2UgQ2FzZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbnVsbCBhbmQgdW5kZWZpbmVkIHZhbHVlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG51bGxWYWx1ZSA9IG51bGw7XG4gICAgICBjb25zdCB1bmRlZmluZWRWYWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgIGNvbnN0IGVtcHR5U3RyaW5nID0gJyc7XG4gICAgICBjb25zdCBlbXB0eUFycmF5OiBhbnlbXSA9IFtdO1xuICAgICAgY29uc3QgZW1wdHlPYmplY3QgPSB7fTtcblxuICAgICAgZXhwZWN0KG51bGxWYWx1ZSkudG9CZU51bGwoKTtcbiAgICAgIGV4cGVjdCh1bmRlZmluZWRWYWx1ZSkudG9CZVVuZGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGVtcHR5U3RyaW5nKS50b0JlKCcnKTtcbiAgICAgIGV4cGVjdChlbXB0eVN0cmluZykudG9IYXZlTGVuZ3RoKDApO1xuICAgICAgZXhwZWN0KGVtcHR5QXJyYXkpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICAgIGV4cGVjdChPYmplY3Qua2V5cyhlbXB0eU9iamVjdCkpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHR5cGUgY2hlY2tpbmcnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdHJpbmdWYWx1ZSA9ICd0ZXN0JztcbiAgICAgIGNvbnN0IG51bWJlclZhbHVlID0gNDI7XG4gICAgICBjb25zdCBib29sZWFuVmFsdWUgPSB0cnVlO1xuICAgICAgY29uc3QgYXJyYXlWYWx1ZSA9IFsxLCAyLCAzXTtcbiAgICAgIGNvbnN0IG9iamVjdFZhbHVlID0geyBrZXk6ICd2YWx1ZScgfTtcblxuICAgICAgZXhwZWN0KHR5cGVvZiBzdHJpbmdWYWx1ZSkudG9CZSgnc3RyaW5nJyk7XG4gICAgICBleHBlY3QodHlwZW9mIG51bWJlclZhbHVlKS50b0JlKCdudW1iZXInKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgYm9vbGVhblZhbHVlKS50b0JlKCdib29sZWFuJyk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShhcnJheVZhbHVlKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCh0eXBlb2Ygb2JqZWN0VmFsdWUpLnRvQmUoJ29iamVjdCcpO1xuICAgICAgZXhwZWN0KG9iamVjdFZhbHVlKS5ub3QudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGJvdW5kYXJ5IGNvbmRpdGlvbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtYXhTYWZlSW50ZWdlciA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSO1xuICAgICAgY29uc3QgbWluU2FmZUludGVnZXIgPSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjtcbiAgICAgIGNvbnN0IHBvc2l0aXZlSW5maW5pdHkgPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk7XG4gICAgICBjb25zdCBuZWdhdGl2ZUluZmluaXR5ID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZO1xuXG4gICAgICBleHBlY3QoTnVtYmVyLmlzU2FmZUludGVnZXIobWF4U2FmZUludGVnZXIpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KE51bWJlci5pc1NhZmVJbnRlZ2VyKG1pblNhZmVJbnRlZ2VyKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChOdW1iZXIuaXNGaW5pdGUocG9zaXRpdmVJbmZpbml0eSkpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KE51bWJlci5pc0Zpbml0ZShuZWdhdGl2ZUluZmluaXR5KSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il19