"use strict";
/**
 * Tests for User model and related types
 */
Object.defineProperty(exports, "__esModule", { value: true });
const user_1 = require("../user");
describe('User Model', () => {
    describe('User interface', () => {
        it('should create a valid user object', () => {
            const user = {
                id: 'user-123',
                email: 'test@example.com',
                organizationId: 'org-456',
                role: 'analyst',
                permissions: ['user:read', 'idea:read'],
                profile: {
                    firstName: 'John',
                    lastName: 'Doe',
                    title: 'Senior Analyst',
                    department: 'Research',
                    phoneNumber: '+1-555-0123',
                    timezone: 'America/New_York',
                    language: 'en'
                },
                preferences: {
                    investmentHorizon: 'medium',
                    riskTolerance: 'moderate',
                    preferredSectors: ['technology'],
                    preferredAssetClasses: ['stocks'],
                    excludedInvestments: [],
                    notificationSettings: {
                        email: true,
                        push: false,
                        frequency: 'daily',
                        types: {
                            ideaGeneration: true,
                            marketAlerts: true,
                            complianceIssues: true,
                            systemUpdates: false
                        }
                    }
                },
                isActive: true,
                lastLoginAt: new Date(),
                createdAt: new Date(),
                updatedAt: new Date()
            };
            expect(user).toBeDefined();
            expect(user.id).toBe('user-123');
            expect(user.email).toBe('test@example.com');
            expect(user.role).toBe('analyst');
        });
    });
    describe('UserRegistrationRequest interface', () => {
        const validRequest = {
            email: 'test@example.com',
            password: 'Password123!',
            firstName: 'John',
            lastName: 'Doe',
            organizationId: 'org-123',
            role: 'analyst'
        };
        it('should create a valid registration request', () => {
            expect(validRequest.email).toBe('test@example.com');
            expect(validRequest.role).toBe('analyst');
            expect(validRequest.firstName).toBe('John');
            expect(validRequest.lastName).toBe('Doe');
        });
        it('should support optional fields', () => {
            const requestWithOptionals = {
                ...validRequest,
                title: 'Senior Analyst',
                department: 'Research',
                phoneNumber: '+1-555-0123',
                timezone: 'America/New_York',
                language: 'en'
            };
            expect(requestWithOptionals.title).toBe('Senior Analyst');
            expect(requestWithOptionals.department).toBe('Research');
            expect(requestWithOptionals.phoneNumber).toBe('+1-555-0123');
        });
    });
    describe('UserLoginRequest interface', () => {
        const validRequest = {
            email: 'test@example.com',
            password: 'Password123!'
        };
        it('should create a valid login request', () => {
            expect(validRequest.email).toBe('test@example.com');
            expect(validRequest.password).toBe('Password123!');
        });
        it('should have required fields', () => {
            expect(validRequest).toHaveProperty('email');
            expect(validRequest).toHaveProperty('password');
        });
    });
    describe('NotificationSettings interface', () => {
        it('should create valid notification settings', () => {
            const settings = {
                email: true,
                push: false,
                frequency: 'daily',
                types: {
                    ideaGeneration: true,
                    marketAlerts: true,
                    complianceIssues: true,
                    systemUpdates: false
                }
            };
            expect(settings.email).toBe(true);
            expect(settings.push).toBe(false);
            expect(settings.frequency).toBe('daily');
            expect(settings.types.ideaGeneration).toBe(true);
        });
        it('should support different frequency options', () => {
            const immediateSettings = {
                email: true,
                push: true,
                frequency: 'immediate',
                types: {
                    ideaGeneration: true,
                    marketAlerts: true,
                    complianceIssues: true,
                    systemUpdates: true
                }
            };
            expect(immediateSettings.frequency).toBe('immediate');
        });
    });
    describe('ROLE_PERMISSIONS', () => {
        it('should return correct permissions for analyst role', () => {
            const permissions = user_1.ROLE_PERMISSIONS['analyst'];
            expect(permissions).toContain(user_1.PERMISSIONS.USER_READ);
            expect(permissions).toContain(user_1.PERMISSIONS.IDEA_READ);
            expect(permissions).toContain(user_1.PERMISSIONS.IDEA_WRITE);
            expect(permissions).not.toContain(user_1.PERMISSIONS.ADMIN_WRITE);
        });
        it('should return correct permissions for portfolio-manager role', () => {
            const permissions = user_1.ROLE_PERMISSIONS['portfolio-manager'];
            expect(permissions).toContain(user_1.PERMISSIONS.USER_READ);
            expect(permissions).toContain(user_1.PERMISSIONS.IDEA_READ);
            expect(permissions).toContain(user_1.PERMISSIONS.IDEA_WRITE);
            expect(permissions).toContain(user_1.PERMISSIONS.IDEA_DELETE);
        });
        it('should return correct permissions for administrator role', () => {
            const permissions = user_1.ROLE_PERMISSIONS['administrator'];
            expect(permissions).toContain(user_1.PERMISSIONS.ADMIN_WRITE);
            expect(permissions).toContain(user_1.PERMISSIONS.USER_WRITE);
            expect(permissions).toContain(user_1.PERMISSIONS.USER_DELETE);
        });
        it('should return correct permissions for compliance-officer role', () => {
            const permissions = user_1.ROLE_PERMISSIONS['compliance-officer'];
            expect(permissions).toContain(user_1.PERMISSIONS.COMPLIANCE_READ);
            expect(permissions).toContain(user_1.PERMISSIONS.COMPLIANCE_WRITE);
            expect(permissions).not.toContain(user_1.PERMISSIONS.IDEA_WRITE);
        });
    });
    describe('DEFAULT_USER_PREFERENCES', () => {
        it('should have correct default values', () => {
            expect(user_1.DEFAULT_USER_PREFERENCES.investmentHorizon).toBe('medium');
            expect(user_1.DEFAULT_USER_PREFERENCES.riskTolerance).toBe('moderate');
            expect(user_1.DEFAULT_USER_PREFERENCES.preferredSectors).toEqual([]);
            expect(user_1.DEFAULT_USER_PREFERENCES.preferredAssetClasses).toEqual([]);
            expect(user_1.DEFAULT_USER_PREFERENCES.excludedInvestments).toEqual([]);
        });
        it('should have correct notification settings', () => {
            const notifications = user_1.DEFAULT_USER_PREFERENCES.notificationSettings;
            expect(notifications.email).toBe(true);
            expect(notifications.push).toBe(false);
            expect(notifications.frequency).toBe('daily');
            expect(notifications.types.ideaGeneration).toBe(true);
            expect(notifications.types.systemUpdates).toBe(false);
        });
    });
    describe('DEFAULT_USER_PROFILE', () => {
        it('should have correct default values', () => {
            expect(user_1.DEFAULT_USER_PROFILE.timezone).toBe('UTC');
            expect(user_1.DEFAULT_USER_PROFILE.language).toBe('en');
        });
    });
    describe('PERMISSIONS constants', () => {
        it('should have all required permission constants', () => {
            expect(user_1.PERMISSIONS.USER_READ).toBe('user:read');
            expect(user_1.PERMISSIONS.USER_WRITE).toBe('user:write');
            expect(user_1.PERMISSIONS.IDEA_READ).toBe('idea:read');
            expect(user_1.PERMISSIONS.IDEA_WRITE).toBe('idea:write');
            expect(user_1.PERMISSIONS.ADMIN_WRITE).toBe('admin:write');
        });
        it('should have market data permissions', () => {
            expect(user_1.PERMISSIONS.MARKET_DATA_READ).toBe('market-data:read');
        });
        it('should have proprietary data permissions', () => {
            expect(user_1.PERMISSIONS.PROPRIETARY_DATA_READ).toBe('proprietary-data:read');
            expect(user_1.PERMISSIONS.PROPRIETARY_DATA_WRITE).toBe('proprietary-data:write');
            expect(user_1.PERMISSIONS.PROPRIETARY_DATA_DELETE).toBe('proprietary-data:delete');
        });
    });
    describe('UserUpdateRequest interface', () => {
        it('should support partial profile updates', () => {
            const updateRequest = {
                profile: {
                    firstName: 'Updated Name',
                    title: 'Senior Analyst'
                }
            };
            expect(updateRequest.profile?.firstName).toBe('Updated Name');
            expect(updateRequest.profile?.title).toBe('Senior Analyst');
        });
        it('should support partial preference updates', () => {
            const updateRequest = {
                preferences: {
                    investmentHorizon: 'long',
                    riskTolerance: 'aggressive'
                }
            };
            expect(updateRequest.preferences?.investmentHorizon).toBe('long');
            expect(updateRequest.preferences?.riskTolerance).toBe('aggressive');
        });
        it('should support both profile and preference updates', () => {
            const updateRequest = {
                profile: {
                    firstName: 'Updated Name'
                },
                preferences: {
                    investmentHorizon: 'short'
                }
            };
            expect(updateRequest.profile?.firstName).toBe('Updated Name');
            expect(updateRequest.preferences?.investmentHorizon).toBe('short');
        });
    });
    describe('Password-related interfaces', () => {
        it('should create valid password change request', () => {
            const request = {
                currentPassword: 'OldPassword123!',
                newPassword: 'NewPassword456!'
            };
            expect(request.currentPassword).toBe('OldPassword123!');
            expect(request.newPassword).toBe('NewPassword456!');
        });
        it('should create valid password reset request', () => {
            const request = {
                email: 'test@example.com'
            };
            expect(request.email).toBe('test@example.com');
        });
        it('should create valid password reset confirmation', () => {
            const request = {
                token: 'valid-reset-token',
                newPassword: 'NewPassword123!'
            };
            expect(request.token).toBe('valid-reset-token');
            expect(request.newPassword).toBe('NewPassword123!');
        });
        it('should create valid refresh token request', () => {
            const request = {
                refreshToken: 'valid-refresh-token'
            };
            expect(request.refreshToken).toBe('valid-refresh-token');
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL21vZGVscy9fX3Rlc3RzX18vdXNlci50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFFSCxrQ0FpQmlCO0FBRWpCLFFBQVEsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFO0lBQzFCLFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7UUFDOUIsRUFBRSxDQUFDLG1DQUFtQyxFQUFFLEdBQUcsRUFBRTtZQUMzQyxNQUFNLElBQUksR0FBUztnQkFDakIsRUFBRSxFQUFFLFVBQVU7Z0JBQ2QsS0FBSyxFQUFFLGtCQUFrQjtnQkFDekIsY0FBYyxFQUFFLFNBQVM7Z0JBQ3pCLElBQUksRUFBRSxTQUFTO2dCQUNmLFdBQVcsRUFBRSxDQUFDLFdBQVcsRUFBRSxXQUFXLENBQUM7Z0JBQ3ZDLE9BQU8sRUFBRTtvQkFDUCxTQUFTLEVBQUUsTUFBTTtvQkFDakIsUUFBUSxFQUFFLEtBQUs7b0JBQ2YsS0FBSyxFQUFFLGdCQUFnQjtvQkFDdkIsVUFBVSxFQUFFLFVBQVU7b0JBQ3RCLFdBQVcsRUFBRSxhQUFhO29CQUMxQixRQUFRLEVBQUUsa0JBQWtCO29CQUM1QixRQUFRLEVBQUUsSUFBSTtpQkFDZjtnQkFDRCxXQUFXLEVBQUU7b0JBQ1gsaUJBQWlCLEVBQUUsUUFBUTtvQkFDM0IsYUFBYSxFQUFFLFVBQVU7b0JBQ3pCLGdCQUFnQixFQUFFLENBQUMsWUFBWSxDQUFDO29CQUNoQyxxQkFBcUIsRUFBRSxDQUFDLFFBQVEsQ0FBQztvQkFDakMsbUJBQW1CLEVBQUUsRUFBRTtvQkFDdkIsb0JBQW9CLEVBQUU7d0JBQ3BCLEtBQUssRUFBRSxJQUFJO3dCQUNYLElBQUksRUFBRSxLQUFLO3dCQUNYLFNBQVMsRUFBRSxPQUFPO3dCQUNsQixLQUFLLEVBQUU7NEJBQ0wsY0FBYyxFQUFFLElBQUk7NEJBQ3BCLFlBQVksRUFBRSxJQUFJOzRCQUNs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UUFDdEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO1lBQ25ELE1BQU0sT0FBTyxHQUF3QjtnQkFDbkMsWUFBWSxFQUFFLHFCQUFxQjthQUNwQyxDQUFDO1lBRUYsTUFBTSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQztRQUMzRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlc3RzIGZvciBVc2VyIG1vZGVsIGFuZCByZWxhdGVkIHR5cGVzXG4gKi9cblxuaW1wb3J0IHtcbiAgVXNlcixcbiAgVXNlclByb2ZpbGUsXG4gIFVzZXJQcmVmZXJlbmNlcyxcbiAgVXNlclJlZ2lzdHJhdGlvblJlcXVlc3QsXG4gIFVzZXJMb2dpblJlcXVlc3QsXG4gIFVzZXJVcGRhdGVSZXF1ZXN0LFxuICBQYXNzd29yZENoYW5nZVJlcXVlc3QsXG4gIFBhc3N3b3JkUmVzZXRSZXF1ZXN0LFxuICBQYXNzd29yZFJlc2V0Q29uZmlybVJlcXVlc3QsXG4gIFJlZnJlc2hUb2tlblJlcXVlc3QsXG4gIFVzZXJMb2dpblJlc3BvbnNlLFxuICBOb3RpZmljYXRpb25TZXR0aW5ncyxcbiAgREVGQVVMVF9VU0VSX1BSRUZFUkVOQ0VTLFxuICBERUZBVUxUX1VTRVJfUFJPRklMRSxcbiAgUEVSTUlTU0lPTlMsXG4gIFJPTEVfUEVSTUlTU0lPTlNcbn0gZnJvbSAnLi4vdXNlcic7XG5cbmRlc2NyaWJlKCdVc2VyIE1vZGVsJywgKCkgPT4ge1xuICBkZXNjcmliZSgnVXNlciBpbnRlcmZhY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSB2YWxpZCB1c2VyIG9iamVjdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHVzZXI6IFVzZXIgPSB7XG4gICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICBvcmdhbml6YXRpb25JZDogJ29yZy00NTYnLFxuICAgICAgICByb2xlOiAnYW5hbHlzdCcsXG4gICAgICAgIHBlcm1pc3Npb25zOiBbJ3VzZXI6cmVhZCcsICdpZGVhOnJlYWQnXSxcbiAgICAgICAgcHJvZmlsZToge1xuICAgICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgICAgICB0aXRsZTogJ1NlbmlvciBBbmFseXN0JyxcbiAgICAgICAgICBkZXBhcnRtZW50OiAnUmVzZWFyY2gnLFxuICAgICAgICAgIHBob25lTnVtYmVyOiAnKzEtNTU1LTAxMjMnLFxuICAgICAgICAgIHRpbWV6b25lOiAnQW1lcmljYS9OZXdfWW9yaycsXG4gICAgICAgICAgbGFuZ3VhZ2U6ICdlbidcbiAgICAgICAgfSxcbiAgICAgICAgcHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICBpbnZlc3RtZW50SG9yaXpvbjogJ21lZGl1bScsXG4gICAgICAgICAgcmlza1RvbGVyYW5jZTogJ21vZGVyYXRlJyxcbiAgICAgICAgICBwcmVmZXJyZWRTZWN0b3JzOiBbJ3RlY2hub2xvZ3knXSxcbiAgICAgICAgICBwcmVmZXJyZWRBc3NldENsYXNzZXM6IFsnc3RvY2tzJ10sXG4gICAgICAgICAgZXhjbHVkZWRJbnZlc3RtZW50czogW10sXG4gICAgICAgICAgbm90aWZpY2F0aW9uU2V0dGluZ3M6IHtcbiAgICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgICAgcHVzaDogZmFsc2UsXG4gICAgICAgICAgICBmcmVxdWVuY3k6ICdkYWlseScsXG4gICAgICAgICAgICB0eXBlczoge1xuICAgICAgICAgICAgICBpZGVhR2VuZXJhdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgbWFya2V0QWxlcnRzOiB0cnVlLFxuICAgICAgICAgICAgICBjb21wbGlhbmNlSXNzdWVzOiB0cnVlLFxuICAgICAgICAgICAgICBzeXN0ZW1VcGRhdGVzOiBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAgIGxhc3RMb2dpbkF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgfTtcblxuICAgICAgZXhwZWN0KHVzZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodXNlci5pZCkudG9CZSgndXNlci0xMjMnKTtcbiAgICAgIGV4cGVjdCh1c2VyLmVtYWlsKS50b0JlKCd0ZXN0QGV4YW1wbGUuY29tJyk7XG4gICAgICBleHBlY3QodXNlci5yb2xlKS50b0JlKCdhbmFseXN0Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVc2VyUmVnaXN0cmF0aW9uUmVxdWVzdCBpbnRlcmZhY2UnLCAoKSA9PiB7XG4gICAgY29uc3QgdmFsaWRSZXF1ZXN0OiBVc2VyUmVnaXN0cmF0aW9uUmVxdWVzdCA9IHtcbiAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICBwYXNzd29yZDogJ1Bhc3N3b3JkMTIzIScsXG4gICAgICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgICAgIGxhc3ROYW1lOiAnRG9lJyxcbiAgICAgIG9yZ2FuaXphdGlvbklkOiAnb3JnLTEyMycsXG4gICAgICByb2xlOiAnYW5hbHlzdCdcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSB2YWxpZCByZWdpc3RyYXRpb24gcmVxdWVzdCcsICgpID0+IHtcbiAgICAgIGV4cGVjdCh2YWxpZFJlcXVlc3QuZW1haWwpLnRvQmUoJ3Rlc3RAZXhhbXBsZS5jb20nKTtcbiAgICAgIGV4cGVjdCh2YWxpZFJlcXVlc3Qucm9sZSkudG9CZSgnYW5hbHlzdCcpO1xuICAgICAgZXhwZWN0KHZhbGlkUmVxdWVzdC5maXJzdE5hbWUpLnRvQmUoJ0pvaG4nKTtcbiAgICAgIGV4cGVjdCh2YWxpZFJlcXVlc3QubGFzdE5hbWUpLnRvQmUoJ0RvZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzdXBwb3J0IG9wdGlvbmFsIGZpZWxkcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3RXaXRoT3B0aW9uYWxzOiBVc2VyUmVnaXN0cmF0aW9uUmVxdWVzdCA9IHtcbiAgICAgICAgLi4udmFsaWRSZXF1ZXN0LFxuICAgICAgICB0aXRsZTogJ1NlbmlvciBBbmFseXN0JyxcbiAgICAgICAgZGVwYXJ0bWVudDogJ1Jlc2VhcmNoJyxcbiAgICAgICAgcGhvbmVOdW1iZXI6ICcrMS01NTUtMDEyMycsXG4gICAgICAgIHRpbWV6b25lOiAnQW1lcmljYS9OZXdfWW9yaycsXG4gICAgICAgIGxhbmd1YWdlOiAnZW4nXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QocmVxdWVzdFdpdGhPcHRpb25hbHMudGl0bGUpLnRvQmUoJ1NlbmlvciBBbmFseXN0Jyk7XG4gICAgICBleHBlY3QocmVxdWVzdFdpdGhPcHRpb25hbHMuZGVwYXJ0bWVudCkudG9CZSgnUmVzZWFyY2gnKTtcbiAgICAgIGV4cGVjdChyZXF1ZXN0V2l0aE9wdGlvbmFscy5waG9uZU51bWJlcikudG9CZSgnKzEtNTU1LTAxMjMnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1VzZXJMb2dpblJlcXVlc3QgaW50ZXJmYWNlJywgKCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkUmVxdWVzdDogVXNlckxvZ2luUmVxdWVzdCA9IHtcbiAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICBwYXNzd29yZDogJ1Bhc3N3b3JkMTIzISdcbiAgICB9O1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSB2YWxpZCBsb2dpbiByZXF1ZXN0JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KHZhbGlkUmVxdWVzdC5lbWFpbCkudG9CZSgndGVzdEBleGFtcGxlLmNvbScpO1xuICAgICAgZXhwZWN0KHZhbGlkUmVxdWVzdC5wYXNzd29yZCkudG9CZSgnUGFzc3dvcmQxMjMhJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgcmVxdWlyZWQgZmllbGRzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KHZhbGlkUmVxdWVzdCkudG9IYXZlUHJvcGVydHkoJ2VtYWlsJyk7XG4gICAgICBleHBlY3QodmFsaWRSZXF1ZXN0KS50b0hhdmVQcm9wZXJ0eSgncGFzc3dvcmQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ05vdGlmaWNhdGlvblNldHRpbmdzIGludGVyZmFjZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSB2YWxpZCBub3RpZmljYXRpb24gc2V0dGluZ3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzZXR0aW5nczogTm90aWZpY2F0aW9uU2V0dGluZ3MgPSB7XG4gICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICBwdXNoOiBmYWxzZSxcbiAgICAgICAgZnJlcXVlbmN5OiAnZGFpbHknLFxuICAgICAgICB0eXBlczoge1xuICAgICAgICAgIGlkZWFHZW5lcmF0aW9uOiB0cnVlLFxuICAgICAgICAgIG1hcmtldEFsZXJ0czogdHJ1ZSxcbiAgICAgICAgICBjb21wbGlhbmNlSXNzdWVzOiB0cnVlLFxuICAgICAgICAgIHN5c3RlbVVwZGF0ZXM6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChzZXR0aW5ncy5lbWFpbCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChzZXR0aW5ncy5wdXNoKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChzZXR0aW5ncy5mcmVxdWVuY3kpLnRvQmUoJ2RhaWx5Jyk7XG4gICAgICBleHBlY3Qoc2V0dGluZ3MudHlwZXMuaWRlYUdlbmVyYXRpb24pLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN1cHBvcnQgZGlmZmVyZW50IGZyZXF1ZW5jeSBvcHRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW1tZWRpYXRlU2V0dGluZ3M6IE5vdGlmaWNhdGlvblNldHRpbmdzID0ge1xuICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgcHVzaDogdHJ1ZSxcbiAgICAgICAgZnJlcXVlbmN5OiAnaW1tZWRpYXRlJyxcbiAgICAgICAgdHlwZXM6IHtcbiAgICAgICAgICBpZGVhR2VuZXJhdGlvbjogdHJ1ZSxcbiAgICAgICAgICBtYXJrZXRBbGVydHM6IHRydWUsXG4gICAgICAgICAgY29tcGxpYW5jZUlzc3VlczogdHJ1ZSxcbiAgICAgICAgICBzeXN0ZW1VcGRhdGVzOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChpbW1lZGlhdGVTZXR0aW5ncy5mcmVxdWVuY3kpLnRvQmUoJ2ltbWVkaWF0ZScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUk9MRV9QRVJNSVNTSU9OUycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0IHBlcm1pc3Npb25zIGZvciBhbmFseXN0IHJvbGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwZXJtaXNzaW9ucyA9IFJPTEVfUEVSTUlTU0lPTlNbJ2FuYWx5c3QnXTtcbiAgICAgIGV4cGVjdChwZXJtaXNzaW9ucykudG9Db250YWluKFBFUk1JU1NJT05TLlVTRVJfUkVBRCk7XG4gICAgICBleHBlY3QocGVybWlzc2lvbnMpLnRvQ29udGFpbihQRVJNSVNTSU9OUy5JREVBX1JFQUQpO1xuICAgICAgZXhwZWN0KHBlcm1pc3Npb25zKS50b0NvbnRhaW4oUEVSTUlTU0lPTlMuSURFQV9XUklURSk7XG4gICAgICBleHBlY3QocGVybWlzc2lvbnMpLm5vdC50b0NvbnRhaW4oUEVSTUlTU0lPTlMuQURNSU5fV1JJVEUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBwZXJtaXNzaW9ucyBmb3IgcG9ydGZvbGlvLW1hbmFnZXIgcm9sZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHBlcm1pc3Npb25zID0gUk9MRV9QRVJNSVNTSU9OU1sncG9ydGZvbGlvLW1hbmFnZXInXTtcbiAgICAgIGV4cGVjdChwZXJtaXNzaW9ucykudG9Db250YWluKFBFUk1JU1NJT05TLlVTRVJfUkVBRCk7XG4gICAgICBleHBlY3QocGVybWlzc2lvbnMpLnRvQ29udGFpbihQRVJNSVNTSU9OUy5JREVBX1JFQUQpO1xuICAgICAgZXhwZWN0KHBlcm1pc3Npb25zKS50b0NvbnRhaW4oUEVSTUlTU0lPTlMuSURFQV9XUklURSk7XG4gICAgICBleHBlY3QocGVybWlzc2lvbnMpLnRvQ29udGFpbihQRVJNSVNTSU9OUy5JREVBX0RFTEVURSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb3JyZWN0IHBlcm1pc3Npb25zIGZvciBhZG1pbmlzdHJhdG9yIHJvbGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwZXJtaXNzaW9ucyA9IFJPTEVfUEVSTUlTU0lPTlNbJ2FkbWluaXN0cmF0b3InXTtcbiAgICAgIGV4cGVjdChwZXJtaXNzaW9ucykudG9Db250YWluKFBFUk1JU1NJT05TLkFETUlOX1dSSVRFKTtcbiAgICAgIGV4cGVjdChwZXJtaXNzaW9ucykudG9Db250YWluKFBFUk1JU1NJT05TLlVTRVJfV1JJVEUpO1xuICAgICAgZXhwZWN0KHBlcm1pc3Npb25zKS50b0NvbnRhaW4oUEVSTUlTU0lPTlMuVVNFUl9ERUxFVEUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBwZXJtaXNzaW9ucyBmb3IgY29tcGxpYW5jZS1vZmZpY2VyIHJvbGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwZXJtaXNzaW9ucyA9IFJPTEVfUEVSTUlTU0lPTlNbJ2NvbXBsaWFuY2Utb2ZmaWNlciddO1xuICAgICAgZXhwZWN0KHBlcm1pc3Npb25zKS50b0NvbnRhaW4oUEVSTUlTU0lPTlMuQ09NUExJQU5DRV9SRUFEKTtcbiAgICAgIGV4cGVjdChwZXJtaXNzaW9ucykudG9Db250YWluKFBFUk1JU1NJT05TLkNPTVBMSUFOQ0VfV1JJVEUpO1xuICAgICAgZXhwZWN0KHBlcm1pc3Npb25zKS5ub3QudG9Db250YWluKFBFUk1JU1NJT05TLklERUFfV1JJVEUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnREVGQVVMVF9VU0VSX1BSRUZFUkVOQ0VTJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBjb3JyZWN0IGRlZmF1bHQgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KERFRkFVTFRfVVNFUl9QUkVGRVJFTkNFUy5pbnZlc3RtZW50SG9yaXpvbikudG9CZSgnbWVkaXVtJyk7XG4gICAgICBleHBlY3QoREVGQVVMVF9VU0VSX1BSRUZFUkVOQ0VTLnJpc2tUb2xlcmFuY2UpLnRvQmUoJ21vZGVyYXRlJyk7XG4gICAgICBleHBlY3QoREVGQVVMVF9VU0VSX1BSRUZFUkVOQ0VTLnByZWZlcnJlZFNlY3RvcnMpLnRvRXF1YWwoW10pO1xuICAgICAgZXhwZWN0KERFRkFVTFRfVVNFUl9QUkVGRVJFTkNFUy5wcmVmZXJyZWRBc3NldENsYXNzZXMpLnRvRXF1YWwoW10pO1xuICAgICAgZXhwZWN0KERFRkFVTFRfVVNFUl9QUkVGRVJFTkNFUy5leGNsdWRlZEludmVzdG1lbnRzKS50b0VxdWFsKFtdKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBjb3JyZWN0IG5vdGlmaWNhdGlvbiBzZXR0aW5ncycsICgpID0+IHtcbiAgICAgIGNvbnN0IG5vdGlmaWNhdGlvbnMgPSBERUZBVUxUX1VTRVJfUFJFRkVSRU5DRVMubm90aWZpY2F0aW9uU2V0dGluZ3M7XG4gICAgICBleHBlY3Qobm90aWZpY2F0aW9ucy5lbWFpbCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChub3RpZmljYXRpb25zLnB1c2gpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KG5vdGlmaWNhdGlvbnMuZnJlcXVlbmN5KS50b0JlKCdkYWlseScpO1xuICAgICAgZXhwZWN0KG5vdGlmaWNhdGlvbnMudHlwZXMuaWRlYUdlbmVyYXRpb24pLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3Qobm90aWZpY2F0aW9ucy50eXBlcy5zeXN0ZW1VcGRhdGVzKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RFRkFVTFRfVVNFUl9QUk9GSUxFJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBjb3JyZWN0IGRlZmF1bHQgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KERFRkFVTFRfVVNFUl9QUk9GSUxFLnRpbWV6b25lKS50b0JlKCdVVEMnKTtcbiAgICAgIGV4cGVjdChERUZBVUxUX1VTRVJfUFJPRklMRS5sYW5ndWFnZSkudG9CZSgnZW4nKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BFUk1JU1NJT05TIGNvbnN0YW50cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgYWxsIHJlcXVpcmVkIHBlcm1pc3Npb24gY29uc3RhbnRzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KFBFUk1JU1NJT05TLlVTRVJfUkVBRCkudG9CZSgndXNlcjpyZWFkJyk7XG4gICAgICBleHBlY3QoUEVSTUlTU0lPTlMuVVNFUl9XUklURSkudG9CZSgndXNlcjp3cml0ZScpO1xuICAgICAgZXhwZWN0KFBFUk1JU1NJT05TLklERUFfUkVBRCkudG9CZSgnaWRlYTpyZWFkJyk7XG4gICAgICBleHBlY3QoUEVSTUlTU0lPTlMuSURFQV9XUklURSkudG9CZSgnaWRlYTp3cml0ZScpO1xuICAgICAgZXhwZWN0KFBFUk1JU1NJT05TLkFETUlOX1dSSVRFKS50b0JlKCdhZG1pbjp3cml0ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYXZlIG1hcmtldCBkYXRhIHBlcm1pc3Npb25zJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KFBFUk1JU1NJT05TLk1BUktFVF9EQVRBX1JFQUQpLnRvQmUoJ21hcmtldC1kYXRhOnJlYWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBwcm9wcmlldGFyeSBkYXRhIHBlcm1pc3Npb25zJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KFBFUk1JU1NJT05TLlBST1BSSUVUQVJZX0RBVEFfUkVBRCkudG9CZSgncHJvcHJpZXRhcnktZGF0YTpyZWFkJyk7XG4gICAgICBleHBlY3QoUEVSTUlTU0lPTlMuUFJPUFJJRVRBUllfREFUQV9XUklURSkudG9CZSgncHJvcHJpZXRhcnktZGF0YTp3cml0ZScpO1xuICAgICAgZXhwZWN0KFBFUk1JU1NJT05TLlBST1BSSUVUQVJZX0RBVEFfREVMRVRFKS50b0JlKCdwcm9wcmlldGFyeS1kYXRhOmRlbGV0ZScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVXNlclVwZGF0ZVJlcXVlc3QgaW50ZXJmYWNlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc3VwcG9ydCBwYXJ0aWFsIHByb2ZpbGUgdXBkYXRlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHVwZGF0ZVJlcXVlc3Q6IFVzZXJVcGRhdGVSZXF1ZXN0ID0ge1xuICAgICAgICBwcm9maWxlOiB7XG4gICAgICAgICAgZmlyc3ROYW1lOiAnVXBkYXRlZCBOYW1lJyxcbiAgICAgICAgICB0aXRsZTogJ1NlbmlvciBBbmFseXN0J1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBleHBlY3QodXBkYXRlUmVxdWVzdC5wcm9maWxlPy5maXJzdE5hbWUpLnRvQmUoJ1VwZGF0ZWQgTmFtZScpO1xuICAgICAgZXhwZWN0KHVwZGF0ZVJlcXVlc3QucHJvZmlsZT8udGl0bGUpLnRvQmUoJ1NlbmlvciBBbmFseXN0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN1cHBvcnQgcGFydGlhbCBwcmVmZXJlbmNlIHVwZGF0ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB1cGRhdGVSZXF1ZXN0OiBVc2VyVXBkYXRlUmVxdWVzdCA9IHtcbiAgICAgICAgcHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICBpbnZlc3RtZW50SG9yaXpvbjogJ2xvbmcnLFxuICAgICAgICAgIHJpc2tUb2xlcmFuY2U6ICdhZ2dyZXNzaXZlJ1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBleHBlY3QodXBkYXRlUmVxdWVzdC5wcmVmZXJlbmNlcz8uaW52ZXN0bWVudEhvcml6b24pLnRvQmUoJ2xvbmcnKTtcbiAgICAgIGV4cGVjdCh1cGRhdGVSZXF1ZXN0LnByZWZlcmVuY2VzPy5yaXNrVG9sZXJhbmNlKS50b0JlKCdhZ2dyZXNzaXZlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN1cHBvcnQgYm90aCBwcm9maWxlIGFuZCBwcmVmZXJlbmNlIHVwZGF0ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB1cGRhdGVSZXF1ZXN0OiBVc2VyVXBkYXRlUmVxdWVzdCA9IHtcbiAgICAgICAgcHJvZmlsZToge1xuICAgICAgICAgIGZpcnN0TmFtZTogJ1VwZGF0ZWQgTmFtZSdcbiAgICAgICAgfSxcbiAgICAgICAgcHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICBpbnZlc3RtZW50SG9yaXpvbjogJ3Nob3J0J1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBleHBlY3QodXBkYXRlUmVxdWVzdC5wcm9maWxlPy5maXJzdE5hbWUpLnRvQmUoJ1VwZGF0ZWQgTmFtZScpO1xuICAgICAgZXhwZWN0KHVwZGF0ZVJlcXVlc3QucHJlZmVyZW5jZXM/LmludmVzdG1lbnRIb3Jpem9uKS50b0JlKCdzaG9ydCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGFzc3dvcmQtcmVsYXRlZCBpbnRlcmZhY2VzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIHZhbGlkIHBhc3N3b3JkIGNoYW5nZSByZXF1ZXN0JywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdDogUGFzc3dvcmRDaGFuZ2VSZXF1ZXN0ID0ge1xuICAgICAgICBjdXJyZW50UGFzc3dvcmQ6ICdPbGRQYXNzd29yZDEyMyEnLFxuICAgICAgICBuZXdQYXNzd29yZDogJ05ld1Bhc3N3b3JkNDU2ISdcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChyZXF1ZXN0LmN1cnJlbnRQYXNzd29yZCkudG9CZSgnT2xkUGFzc3dvcmQxMjMhJyk7XG4gICAgICBleHBlY3QocmVxdWVzdC5uZXdQYXNzd29yZCkudG9CZSgnTmV3UGFzc3dvcmQ0NTYhJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSB2YWxpZCBwYXNzd29yZCByZXNldCByZXF1ZXN0JywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdDogUGFzc3dvcmRSZXNldFJlcXVlc3QgPSB7XG4gICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbSdcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChyZXF1ZXN0LmVtYWlsKS50b0JlKCd0ZXN0QGV4YW1wbGUuY29tJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSB2YWxpZCBwYXNzd29yZCByZXNldCBjb25maXJtYXRpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXF1ZXN0OiBQYXNzd29yZFJlc2V0Q29uZmlybVJlcXVlc3QgPSB7XG4gICAgICAgIHRva2VuOiAndmFsaWQtcmVzZXQtdG9rZW4nLFxuICAgICAgICBuZXdQYXNzd29yZDogJ05ld1Bhc3N3b3JkMTIzISdcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChyZXF1ZXN0LnRva2VuKS50b0JlKCd2YWxpZC1yZXNldC10b2tlbicpO1xuICAgICAgZXhwZWN0KHJlcXVlc3QubmV3UGFzc3dvcmQpLnRvQmUoJ05ld1Bhc3N3b3JkMTIzIScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgdmFsaWQgcmVmcmVzaCB0b2tlbiByZXF1ZXN0JywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdDogUmVmcmVzaFRva2VuUmVxdWVzdCA9IHtcbiAgICAgICAgcmVmcmVzaFRva2VuOiAndmFsaWQtcmVmcmVzaC10b2tlbidcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChyZXF1ZXN0LnJlZnJlc2hUb2tlbikudG9CZSgndmFsaWQtcmVmcmVzaC10b2tlbicpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdfQ==